<!DOCTYPE html>
<html>
<head>
<script src="https://unpkg.com/konva@8.3.2/konva.min.js"></script>
<script src="grid.js"></script>
<title>U3A2 Demo</title>
</head>
<body>
<div id="konvaCanvas"></div>
<script>
	'use strict'

    let stage = new Konva.Stage({
        container: 'konvaCanvas',
        width: window.innerWidth,
        height: window.innerHeight
    });
    let layer = new Konva.Layer();
	stage.add(layer); // add the layer to the stage

    //----- Ignore everything above here for now -----//

    let rect = new Konva.Rect({
        x: 10,
        y: 10,
        width: 100,
        height: 80,
        fill: 'red',
    });
    layer.add(rect)

    rect.on('mouseover', handleMouseOver)
    rect.on('mouseout', handleMouseOut)
    rect.on('click', handleClick)

    setTimeout(handleTimeout, 5000) // this will call the handleTimeout function after 5 seconds

    function handleMouseOver() {
        rect.fill('green')
    }

    function handleMouseOut() {
        rect.fill('red')
    }

    function handleClick() {
        let tween = new Konva.Tween({
            node: rect,
            duration: 1,
            x: 400,
            y: 200,
            fill: 'blue',
            rotation: 90,
            scaleX: 2,
            scaleY: 2,
            onFinish: handleTweenDone
        });
        tween.play()
        console.log("tween.play is asynchronous - this will show up during the tween")
    }

    function handleTweenDone() {
        console.log("The tween is now done.")
        rect.stroke("black")
        rect.strokeWidth(3)
    }

    function handleTimeout() {
        let circle = new Konva.Circle({
            x: 100,
            y: 300,
            radius: 50,
            fill: "lightblue"
        })
        layer.add(circle)
    }

    //----- Ignore everything below here for now -----//

</script>
</body>
</html>